(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"+H8J":function(e,t,n){"use strict";n.r(t)},"09zc":function(e,t,n){"use strict";n.r(t)},"6yDj":function(e,t,n){"use strict";n.r(t)},"8UYM":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchInput=void 0;const a=n("D57K"),s=a.__importStar(n("ERkP")),o=a.__importStar(n("nsO7")),i=n("np6O"),r=n("0x+l"),l=n("myse");n("+H8J");class c extends s.PureComponent{constructor(e){super(e),this.debouncedSearch=o.debounce(()=>{const{courseId:e,notifyStateChange:t,searchAnnouncements:n}=this.props;this.setState({shouldNotify:!0}),this.state.isValidSearch&&n(e,{searchText:encodeURIComponent(this.state.text.trim())})},this.props.debounceTime),this.focusElement=e=>{e.focus()},this.shouldStartSearching=e=>!e.trim().length||e.trim().length>=this.props.minCharToStartSearching,this.showCharacterInsufficient=e=>!!e.trim()&&e.trim().length<this.props.minCharToStartSearching,this.handleSearchTextChange=e=>{const t=e.target.value;this.setState({text:t,isValidSearch:this.shouldStartSearching(t),shouldNotify:!1}),this.debouncedSearch()},this.handleEnterToSearch=e=>{const{searchAnnouncements:t,courseId:n,notifyStateChange:a}=this.props;"Enter"===e.key&&(this.setState(e=>({isValidSearch:e.text.trim().length>0})),this.state.isValidSearch&&(a(this.state.text,this.state.isCollapsed,this.state.isValidSearch),t(n,{searchText:encodeURIComponent(this.state.text.trim())})))},this.closeSearchInput=()=>{this.setState({text:"",isCollapsed:!0,isValidSearch:!1})},this.state={text:"",isCollapsed:!1,isValidSearch:!1,shouldNotify:!0}}UNSAFE_componentWillReceiveProps(e){e.isCollapsed&&!e.searchText.trim().length&&this.debouncedSearch.cancel(),this.setState({text:e.searchText,isCollapsed:e.isCollapsed})}componentDidUpdate(e,t){const{isCollapsed:n,notifyStateChange:a}=this.props;!0===e.isCollapsed&&n!==e.isCollapsed&&this.focusElement(this.searchInput),this.showCharacterInsufficient(this.state.text)?this.searchInput.addEventListener("keyup",this.handleEnterToSearch):this.searchInput.removeEventListener("keyup",this.handleEnterToSearch),this.state.shouldNotify&&a(this.state.text,this.state.isCollapsed,this.state.isValidSearch)}render(){const{localize:e,analyticsId:t,analyticsEventAugmentor:n}=this.props,a=n(l.AnalyticsEventTypes.CLICK_EVENT,()=>{},t);return s.createElement("div",{className:"search-input-wrap","data-analytics-id":t},s.createElement(r.Search,{className:"search-icon"}),s.createElement("label",{className:"sr-only",htmlFor:"search-input"},this.props.placeHolder),s.createElement("input",{className:"left",id:"search-input",onChange:this.handleSearchTextChange,placeholder:this.props.placeHolder,ref:e=>{this.searchInput=e},type:"text",value:this.state.text,onClick:a}),s.createElement(i.AnalyticsIconButton,{"aria-label":e.translate("course.announcements.button.closeSearch"),className:"search-controls button super-clear",onClick:this.closeSearchInput,title:e.translate("course.announcements.button.closeSearch"),analyticsId:"course.announcements.listPanel.closeSearch.button"},s.createElement(r.Clear,null)))}}t.SearchInput=c,t.default=(0,l.withAnalytics)(c)},AfBz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAnnouncementListItem=void 0;const a=n("D57K"),s=a.__importStar(n("ERkP")),o=a.__importDefault(n("wgY5")),i=n("MC1S"),r=n("WBPx"),l=n("caKH"),c=a.__importDefault(n("RK7K")),u=n("vSnM");n("cwrT");const d=n("myse"),m=n("Pam5"),h=n("0x+l");class p extends s.Component{constructor(e){super(e),this.timerHandler=null,this.onClickActionMenu=e=>{this.setState({target:e.currentTarget})},this.onOpenDeleteConfirmDialog=()=>{this.setState({hideDialog:!1})},this.onCloseDeleteConfirmDialog=()=>{this.setState({hideDialog:!0})},this.onOpenAnnouncement=()=>{const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n)},this.onPostAnnouncement=()=>{this.setState({disablePostButton:!0});const{saveAnnouncement:e,courseId:t,announcement:n}=this.props;e(t,{...n,isDraft:!1,startDateRestriction:(0,o.default)().toDate(),endDateRestriction:null}).catch(()=>this.setState({disablePostButton:!1}))},this.onEditAnnouncement=()=>{this.setState({disablePostButton:!1});const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n,c.default.EDIT)},this.onDuplicateAnnouncement=()=>{const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n,c.default.DUPLICATE)},this.onDeleteAnnouncement=()=>{const{removeAnnouncement:e,announcement:t,loadAnnouncements:n,courseId:a}=this.props;e(t.courseId,t.id).then(()=>{this.onCloseDeleteConfirmDialog(),n(a,{})})},this.isPostedAnnouncement=e=>!(e.isDraft||e.startDateRestriction&&(0,o.default)(e.startDateRestriction).isAfter((0,o.default)())),this.getActionOptions=e=>{const{permissions:t,analyticsId:n,analyticsEventAugmentor:a}=this.props,o={items:[]},i=a(d.AnalyticsEventTypes.CLICK_EVENT,this.onEditAnnouncement,n+".listItem.edit.button"),r=a(d.AnalyticsEventTypes.CLICK_EVENT,this.onDuplicateAnnouncement,n+".listItem.duplicate.button"),l=a(d.AnalyticsEventTypes.CLICK_EVENT,this.onOpenDeleteConfirmDialog,n+".listItem.delete.button");return t&&t.modify&&o.items.push({key:c.default.EDIT,name:e.translate("course.announcements.button.edit"),icon:s.createElement(h.Edit,null),onClick:i}),t&&t.create&&o.items.push({key:c.default.DUPLICATE,name:e.translate("course.announcements.button.duplicate"),icon:s.createElement(h.Duplicate,null),onClick:r}),t&&t.delete&&o.items.push({key:c.default.DELETE,name:e.translate("course.announcements.button.delete"),icon:s.createElement(h.Trash,null),onClick:l}),o},this.renderItemStatus=()=>{const{announcement:e,localize:t,permissions:n,analyticsId:a,isCourseAvailable:o,isCompact:i}=this.props;let l=`course.announcements.status.${this.isPostedAnnouncement(e)?"posted":"inSchedule"}.${i?"uppercase":"capitalize"}`;return e.isDraft&&(l="course.announcements.status.draft"),s.createElement("div",{className:"item-status-info"},e.isDraft&&n.modify?s.createElement(r.AnalyticsDefaultButton,{"data-automation-id":"test",onClick:this.onPostAnnouncement,disabled:!n.viewUnposted||!o||this.state.disablePostButton,analyticsId:`${a}.listItem.postNow`},t.translate("course.announcements.button.postNow")):s.createElement("div",null,s.createElement("span",{className:"list-item-status"},n.viewUnposted&&t.translate(l)),s.createElement("span",{className:"list-item-date-sent"},e.startDateRestriction&&!e.isDraft&&(0,u.displayDateTime)(e.startDateRestriction.toISOString(),t))))},this.registerTimeoutEvent=()=>{const{debounceTime:e,onExpire:t,announcement:n}=this.props;this.timerHandler=setTimeout(()=>{t(n.id)},e)},this.renderDialog=()=>{const{localize:e,analyticsId:t}=this.props;return s.createElement(l.UltraModalDialog,{onDismiss:()=>{this.setState({hideDialog:!0})},showAsCallout:!this.state.hideDialog,target:this.state.target,dialogContentProps:{type:i.DialogType.actionConfirmation,title:e.translate("course.announcements.dialogText.deleteAnnouncement"),subText:e.translate("course.announcements.dialogText.confirmDeleteAnnouncement"),showCloseButton:!1},analyticsId:t+".listItem.deleteDialog"},s.createElement(i.DialogFooter,null,s.createElement(r.AnalyticsDefaultButton,{onClick:this.onCloseDeleteConfirmDialog,analyticsId:t+".listItem.deleteDialog.cancel.button"},e.translate("course.announcements.button.cancel")),s.createElement(r.AnalyticsPrimaryButton,{onClick:this.onDeleteAnnouncement,className:"deleteConfirmBtn",analyticsId:t+".listItem.deleteDialog.confirm.button"},e.translate("course.announcements.button.delete"))))},this.state={hideDialog:!0,target:null,disablePostButton:!1}}componentDidMount(){this.props.isNewlyCreated&&this.registerTimeoutEvent()}componentDidUpdate(e){!e.isNewlyCreated&&this.props.isNewlyCreated&&this.registerTimeoutEvent()}componentWillUnmount(){this.timerHandler&&clearTimeout(this.timerHandler)}render(){const{announcement:e,localize:t,permissions:n,isNewlyCreated:a,analyticsId:o,analyticsEventAugmentor:r,isCompact:l}=this.props,c=this.getActionOptions(t),h=r(d.AnalyticsEventTypes.CLICK_EVENT,this.onOpenAnnouncement,o+".listItem.open.link");return s.createElement("tr",{className:`announcement-item-row ${a?"is-new":""}`,role:"row"},s.createElement("td",{className:"announcement-header-column "+(n.viewUnposted?"small-1-2":"large-1"),role:"gridcell"},s.createElement("div",{className:"announcement-header"},s.createElement("div",{className:"small-1-1 announcement-icon"+(e.isDraft?" is-restricted":"")},s.createElement("div",{className:"element-image"},s.createElement(m.Announcement,{color:"primary"}))),s.createElement("div",{className:"click-message-detail"},s.createElement("div",{className:"announcement-title-detail"},s.createElement("a",{className:`list-item-title ${n.viewUnposted?"entitled":""} `,href:"#","data-analytics-id":`${o}.listItem.open.link`,onClick:h},(0,u.decodeHtmlEntities)(e.title)),e.isDraft&&s.createElement("span",{className:"draft-status one-line"},t.translate("course.announcements.status.draft"))),s.createElement("a",{className:"list-item-body "+(n.viewUnposted?"one-line":"three-lines multiple-line-ellipsis"),href:"#",onClick:this.onOpenAnnouncement},e.body&&(0,u.decodeHtmlBodyText)(e.body.rawText,this.props.localize))),l&&this.renderItemStatus())),!l&&s.createElement("td",{className:"announcement-status-column",role:"gridcell"}," ",this.renderItemStatus()," "),n.viewUnposted&&s.createElement("td",{className:"announcement-viewers-column",role:"gridcell"},s.createElement("div",{className:"announcement-viewers",onClick:this.onClickActionMenu},s.createElement("span",{className:"list-item-view-count"},e.readCount||0," / ",e.totalParticipants),c&&c.items&&c.items.length>0&&s.createElement(i.ActionMenu,{ariaLabel:`${t.translate("course.announcements.moreOptions",{announcementTitle:e.title})}`,className:"announcement-item-action-menu",disabled:!this.state.hideDialog,menuProps:c,maintainExpandedProperties:!this.state.hideDialog,analyticsId:o+".listItem.actionMenu"}),this.renderDialog())))}}t.BaseAnnouncementListItem=p,t.default=(0,d.withAnalytics)(p)},CAxA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortControl=t.ICON_CHEVRON_DOWN=t.ICON_CHEVRON_UP=void 0;const a=n("D57K").__importStar(n("ERkP")),s=n("zGdY"),o=n("myse");n("idFC"),t.ICON_CHEVRON_UP="arrow-up",t.ICON_CHEVRON_DOWN="arrow-down";class i extends a.PureComponent{constructor(){super(...arguments),this.getArrowDirection=()=>{const{currentSort:e,sortField:n}=this.props;return n&&(null==e?void 0:e.field)===n?(this.localSort=e,this.isDescendingSort(e)?t.ICON_CHEVRON_DOWN:t.ICON_CHEVRON_UP):""},this.updateSortCriteria=()=>{const{sortField:e,onSwitchSortCriteria:t}=this.props;this.localSort?this.localSort={field:e,direction:this.localSort.direction===s.SortDirection.Ascending?s.SortDirection.Descending:s.SortDirection.Ascending}:this.localSort={field:e,direction:s.SortDirection.Ascending},t(this.localSort)},this.isDescendingSort=e=>e.direction===s.SortDirection.Descending}render(){const{localize:e,viewText:t,analyticsId:n,analyticsEventAugmentor:s}=this.props,i=s(o.AnalyticsEventTypes.CLICK_EVENT,this.updateSortCriteria,n);return a.createElement(a.Fragment,null,a.createElement("button",{id:`sort-by-${t}-button`,className:"active clear",onClick:i,"data-analytics-id":n},a.createElement("span",{className:"sort-description"},e.translate(`course.announcements.sort.${t}.description`)),a.createElement("div",{className:"sort-list-arrows "+this.getArrowDirection(),role:"presentation"},a.createElement("div",{className:"sort-list-arrow-up"}),a.createElement("div",{className:"sort-list-arrow-down"}))))}}t.SortControl=i,t.default=(0,o.withAnalytics)(i)},Hhhn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatePicker=t.getDatePickerDefaultStrings=void 0;const a=n("D57K").__importStar(n("ERkP")),s=n("MC1S"),o=n("np6O"),i=n("0x+l"),r=n("n7/H"),l=n("myse");n("6yDj");t.getDatePickerDefaultStrings=e=>({months:[e.translate("course.announcements.datePicker.months.january"),e.translate("course.announcements.datePicker.months.february"),e.translate("course.announcements.datePicker.months.march"),e.translate("course.announcements.datePicker.months.april"),e.translate("course.announcements.datePicker.months.may"),e.translate("course.announcements.datePicker.months.june"),e.translate("course.announcements.datePicker.months.july"),e.translate("course.announcements.datePicker.months.august"),e.translate("course.announcements.datePicker.months.september"),e.translate("course.announcements.datePicker.months.october"),e.translate("course.announcements.datePicker.months.november"),e.translate("course.announcements.datePicker.months.december")],shortMonths:[e.translate("course.announcements.datePicker.shortMonths.january"),e.translate("course.announcements.datePicker.shortMonths.february"),e.translate("course.announcements.datePicker.shortMonths.march"),e.translate("course.announcements.datePicker.shortMonths.april"),e.translate("course.announcements.datePicker.shortMonths.may"),e.translate("course.announcements.datePicker.shortMonths.june"),e.translate("course.announcements.datePicker.shortMonths.july"),e.translate("course.announcements.datePicker.shortMonths.august"),e.translate("course.announcements.datePicker.shortMonths.september"),e.translate("course.announcements.datePicker.shortMonths.october"),e.translate("course.announcements.datePicker.shortMonths.november"),e.translate("course.announcements.datePicker.shortMonths.december")],days:[e.translate("course.announcements.datePicker.days.sunday"),e.translate("course.announcements.datePicker.days.monday"),e.translate("course.announcements.datePicker.days.tuesday"),e.translate("course.announcements.datePicker.days.wednesday"),e.translate("course.announcements.datePicker.days.thursday"),e.translate("course.announcements.datePicker.days.friday"),e.translate("course.announcements.datePicker.days.saturday")],shortDays:[e.translate("course.announcements.datePicker.shortDays.sunday"),e.translate("course.announcements.datePicker.shortDays.monday"),e.translate("course.announcements.datePicker.shortDays.tuesday"),e.translate("course.announcements.datePicker.shortDays.wednesday"),e.translate("course.announcements.datePicker.shortDays.thursday"),e.translate("course.announcements.datePicker.shortDays.friday"),e.translate("course.announcements.datePicker.shortDays.saturday")],goToToday:e.translate("course.announcements.datePicker.goToToday"),prevMonthAriaLabel:e.translate("course.announcements.datePicker.prevMonthAriaLabel"),nextMonthAriaLabel:e.translate("course.announcements.datePicker.nextMonthAriaLabel"),prevYearAriaLabel:e.translate("course.announcements.datePicker.prevYearAriaLabel"),nextYearAriaLabel:e.translate("course.announcements.datePicker.nextYearAriaLabel")});class c extends a.PureComponent{constructor(e){super(e),this.timeoutPromiseWrapper=(e,t,n)=>new Promise(a=>{e.apply(this,t),setTimeout(()=>{const s=e.apply(n,t);a(s)})}),this.errorMessage=()=>{const{isValueValid:e,errorEmptyMessage:t,errorFormatMessage:n}=this.props;if(!e){let e=n;return this.state.uiDateStr||(e=t),a.createElement("span",{className:"error-message"},a.createElement(i.Attention,null),e)}return null},this.toggleCalendar=()=>{this.setState(e=>({isDisplayCalendar:!e.isDisplayCalendar}),()=>{this.state.isDisplayCalendar&&setTimeout(()=>{this.calRef.focus()},100)})},this.onSelectDate=e=>{const{localize:t,onChangeValue:n}=this.props;this.timeoutPromiseWrapper(t.formatDate,[e,r.ILocaleDateFormat.Short],t).then(t=>{n(e),this.setState({uiDateStr:t}),this.toggleCalendar()})},this.onTypeDate=e=>{this.setState({uiDateStr:e.target.value})},this.onHandleBlur=()=>{const{uiDateStr:e}=this.state,{onChangeValue:t,localize:n}=this.props;setTimeout(()=>{this.datePickerRef.contains(document.activeElement)||this.setState({isDisplayCalendar:!1})}),this.timeoutPromiseWrapper(n.parseDate,[e,r.ILocaleDateFormat.Short],n).then(e=>{e&&t(e)})},this.state={isDisplayCalendar:!1,uiDateStr:""}}componentDidMount(){const{value:e,onChangeValue:t,localize:n}=this.props;e&&this.timeoutPromiseWrapper(n.formatDate,[e,r.ILocaleDateFormat.Short],n).then(n=>{t(e),this.setState({uiDateStr:n})})}componentDidUpdate(e,t){const{uiDateStr:n}=this.state,{value:a,onValidateCallback:s,disabled:o,localize:i}=this.props;a&&a!==e.value&&this.timeoutPromiseWrapper(i.formatDate,[a,r.ILocaleDateFormat.Short],i).then(e=>{this.setState({uiDateStr:e}),s(!0)}),a||a===e.value||(this.setState({uiDateStr:""}),s(!0)),this.state.uiDateStr===t.uiDateStr||o||this.timeoutPromiseWrapper(i.parseDate,[n,r.ILocaleDateFormat.Short],i).then(e=>{s(!!e)})}render(){const{isDisplayCalendar:e,uiDateStr:n}=this.state,{value:r,disabled:c,localize:u,analyticsId:d,analyticsEventAugmentor:m}=this.props,h=m(l.AnalyticsEventTypes.CLICK_EVENT,()=>{},d+".input.text");return a.createElement("div",{ref:e=>this.datePickerRef=e,className:"date-picker"},a.createElement("div",{className:"calendar-input-container","data-analytics-id":`${d}.input.text`},a.createElement("input",{className:"date-input",ref:e=>this.dateInputRef=e,type:"text",value:n,onChange:this.onTypeDate,disabled:c,onClick:h,onBlur:this.onHandleBlur}),a.createElement(o.AnalyticsIconButton,{"aria-label":u.translate("course.announcements.datePicker.dueDate"),className:"btn-date open-datepicker",disabled:c,onClick:this.toggleCalendar,title:u.translate("course.announcements.datePicker.dueDate"),analyticsId:d+".open.button"},a.createElement(i.Calendar,null)),this.errorMessage()),e&&a.createElement(s.Callout,{target:this.dateInputRef,doNotLayer:!0,directionalHint:5,isBeakVisible:!1,gapSpace:0,setInitialFocus:!1},a.createElement(s.Calendar,{componentRef:e=>this.calRef=e,className:"date-picker-dropdown",value:r,strings:(0,t.getDatePickerDefaultStrings)(u),isMonthPickerVisible:!1,showGoToToday:!1,onSelectDate:this.onSelectDate,analyticsId:d+".calendar"})))}}t.DatePicker=c,t.default=(0,l.withAnalytics)(c)},IVgG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementListPanel=t.ANNOUNCEMENT_LIMIT=void 0;const a=n("D57K"),s=a.__importStar(n("ERkP")),o=n("uDfI"),i=a.__importDefault(n("x6OE")),r=a.__importDefault(n("7O4Y")),l=n("np6O"),c=n("FS8K"),u=a.__importDefault(n("AfBz")),d=a.__importDefault(n("8UYM")),m=a.__importDefault(n("CAxA")),h=a.__importDefault(n("RK7K")),p=a.__importDefault(n("xG9T")),E=n("50Q+"),g=n("Y+9S"),S=n("E1pj"),C=n("0x+l"),f=n("8jBL");n("RDrG");const D=n("zGdY"),b=n("IbyE"),A=n("9OUN"),y=n("zGdY"),v=2;t.ANNOUNCEMENT_LIMIT=10;class T extends s.PureComponent{constructor(){super(...arguments),this.renderAnnouncementItem=e=>{const{courseId:t,getAnnouncementsCounts:n,courseContext:a,localize:o,openAnnouncementDetailPanel:i,permissions:r,removeAnnouncement:l,saveAnnouncement:c,recentUpdatedAnnouncementIds:d,removeFromRecentUpdated:m,UltraWindowSize:h}=this.props,p=Object.values(this.props.announcements)[e];return s.createElement(u.default,{announcement:p,courseId:t,debounceTime:2e3,isCompact:null==h?void 0:h.isSmallBreakpoint(),isCourseAvailable:a.isAvailable,isNewlyCreated:d&&d.indexOf(p.id)>-1,localize:o,key:p.id,onExpire:m,openAnnouncementDetailPanel:i,permissions:r,removeAnnouncement:l,saveAnnouncement:c,loadAnnouncements:this.loadAnnByCurrentSettings,analyticsId:"course.announcements.listPanel"})},this.onScroll=()=>{this.shouldStartInfiniteScroll()&&this.loadMore()},this.shouldStartInfiniteScroll=()=>{if(this.list){const{announcements:e,paging:t,isLoading:n}=this.props,[,a]=this.list.getVisibleRange(),s=Object.keys(e).length;return!n&&a>=s-1&&s<(null==t?void 0:t.count)}return!1},this.loadMore=()=>{const{announcements:e,paging:t,loadAnnouncements:n,courseId:a,searchInputState:s,sortCriteria:o}=this.props,i=s.searchText;n(a,{paging:{offset:Object.keys(e).length,limit:t.limit},searchText:i,sort:o},!0)},this.searchInputStateChange=(e,t,n)=>{const{searchInputState:a,changeSearchInputState:s}=this.props;t&&t!==a.isCollapsed?this.onToggleSearchInput():e===a.searchText&&t===a.isCollapsed&&n===a.isValidSearch||s({searchText:e,isCollapsed:t,isValidSearch:n})},this.onToggleSearchInput=()=>{const{courseId:e,searchInputState:t,changeSearchInputState:n}=this.props,a=!t.isCollapsed,s=a?"":t.searchText;n({searchText:s,isCollapsed:a}),a&&t.searchText.trim().length>0&&this.loadAnnByCurrentSettings(e,{searchText:s})},this.onSwitchSortCriteria=e=>{const{courseId:t,switchSortCriteria:n}=this.props;n([e]),this.loadAnnByCurrentSettings(t,{sort:[e]})},this.sortAriaValueForAnnouncement=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.Title?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.sortAriaValueByStatus=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.Status?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.sortAriaValueByViewers=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.ReadCount?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.onCreateAnnouncement=()=>{this.props.openAnnouncementDetailPanel(this.props.courseId,null,this.props.permissions,h.default.CREATE)},this.loadAnnByCurrentSettings=(e,n)=>{const{announcements:a,searchInputState:s,loadAnnouncements:o,sortCriteria:i}=this.props,r=n||{},l=null!=r.searchText?r.searchText:!s.isCollapsed&&s.searchText.trim()||"",c=r.sort||i,u=a&&Object.keys(a).length||0;o(e,{searchText:l,paging:{limit:r.limit||Math.max(u,t.ANNOUNCEMENT_LIMIT),offset:r.offset||0},sort:c})},this.renderNoResultString=e=>{const{searchInputState:t,localize:n,isLoading:a,paging:o,isSearchingSuccessful:i,courseContext:r}=this.props;return t.searchText?e?s.createElement("p",{className:"search-insufficient","aria-live":"assertive"},n.translate("course.announcements.characterInsufficient")):i&&s.createElement("p",{className:"search-no-results ng-scope","aria-live":"assertive"},n.translate("course.announcements.noSearchResult")):!a&&0===(null==o?void 0:o.count)&&t.isCollapsed&&s.createElement("p",{className:"search-no-results ng-scope"},n.translate((0,E.resolveCourseOrgToken)("announcements.noResult",null==r?void 0:r.isOrganization)))},this.getMessageAnnouncementInCourse=()=>{const{localize:e,announcementsCounts:t,announcements:n}=this.props,a=Object.values(n).length,s=t.draftCount+t.postedCount+t.scheduledCount;return e.translate("course.announcements.totalAnnouncementInCourse",{filterCount:a,announcementCount:s})},this.renderAnnouncementListView=e=>{const{localize:t,searchInputState:n,sortCriteria:a,isSearchingSuccessful:o,permissions:l,courseContext:c,UltraWindowSize:u}=this.props,d=n.searchText.trim(),h=!n.isCollapsed&&d.length&&d.length<v&&!n.isValidSearch;return e>0&&!h?s.createElement("div",{className:(0,r.default)("tabular-list-container",{"-with-seach-bar":!n.isCollapsed})},s.createElement("div",{className:"tabular-list"},s.createElement("table",{className:"table-content sortable-table",role:"grid","aria-readonly":!0,"aria-labelledby":"announcement-table-caption"},s.createElement("caption",{id:"announcement-table-caption",className:"sr-only"},t.translate((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==c?void 0:c.isOrganization))),s.createElement("thead",{className:"list-item-columns announcement-sort-header"},s.createElement("tr",{className:"list-item-row announcement-sort-row",role:"row"},s.createElement("th",{className:"column-title sort",role:"columnheader",id:"title","aria-sort":this.sortAriaValueForAnnouncement(a)},s.createElement(m.default,{courseId:this.props.courseId,currentSort:a[0],localize:t,onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:y.LearnCourseAnnouncementSortField.Title,viewText:"title",analyticsId:"course.announcements.listPanel.sortByTitle.button"})),!u.isSmallBreakpoint()&&s.createElement("th",{className:`column-${l.viewUnposted?"status":"date"} sort`,role:"columnheader",id:l.viewUnposted?"status":"date","aria-sort":this.sortAriaValueByStatus(a)},s.createElement(m.default,{courseId:this.props.courseId,currentSort:a[0],localize:t,onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:l.viewUnposted?y.LearnCourseAnnouncementSortField.Status:y.LearnCourseAnnouncementSortField.StartDateRestriction,viewText:this.props.localize.translate(l.viewUnposted?"status":"date"),analyticsId:"course.announcements.listPanel.sortByDate.button"})),l.viewUnposted&&s.createElement("th",{className:"column-viewers sort",role:"columnheader",id:"viewers","aria-sort":this.sortAriaValueByViewers(a)},s.createElement(m.default,{courseId:this.props.courseId,currentSort:a[0],localize:t,onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:y.LearnCourseAnnouncementSortField.ReadCount,viewText:"viewers",analyticsId:"course.announcements.listPanel.sortByViews.button"})))),s.createElement(i.default,{itemsRenderer:(e,t)=>s.createElement("tbody",{ref:t},e),length:Object.values(this.props.announcements).length,itemRenderer:this.renderAnnouncementItem,ref:e=>this.list=e,minSize:50}),n.isValidSearch&&o&&s.createElement("div",{"aria-live":"polite","aria-hidden":!1,className:"sr-only",role:"status"},t.translate("course.announcements.searchResults")))),s.createElement("span",{role:"status",className:"sr-only"},this.getMessageAnnouncementInCourse())):s.createElement("div",{className:"columns small-12 no-result-section"},s.createElement("div",{className:"row"},s.createElement("div",{className:"columns small-12 small-centered text-center ftue-container"},this.renderNoResultString(h))))}}componentDidMount(){const{courseId:e,courseContext:t,getAnnouncementsCounts:n,getCourseContext:a,permissions:s,root:o,switchSortCriteria:i}=this.props;if((0,g.isInMobileApp)()){const e={type:g.MessageType.AnnouncementListOpened,status:g.MessageStatus.Success,permission:{search:!0}},t=(0,g.registerMobileEventHandler)(e);t.response.subscribe(e=>{e.event===g.EventType.Search&&this.onToggleSearchInput()}),this.correlationId=t.correlationId}const r=s.viewUnposted?[{field:y.LearnCourseAnnouncementSortField.ModifiedDate,direction:D.SortDirection.Descending}]:[{field:y.LearnCourseAnnouncementSortField.StartDateRestriction,direction:D.SortDirection.Descending}];i(r),this.loadAnnByCurrentSettings(e,{sort:r}),n(e),t&&t.courseId===e||a(e),(o&&o.querySelector(".panel-wrap")||window).addEventListener("scroll",this.onScroll),(o&&o.querySelector(".panel-wrap")||window).addEventListener("touchmove",this.onScroll)}componentDidUpdate(e){this.props.listener.refreshAnnouncementsCounts&&!e.listener.refreshAnnouncementsCounts&&this.props.getAnnouncementsCounts(this.props.courseId),this.props.listener.resetSortSetting&&!e.listener.resetSortSetting&&this.props.switchSortCriteria([{field:y.LearnCourseAnnouncementSortField.ModifiedDate,direction:D.SortDirection.Descending}]),this.props.listener.resetSearchSetting&&!e.listener.resetSearchSetting&&this.props.changeSearchInputState({searchText:"",isCollapsed:!0}),this.props.listener.refreshAnnouncements&&!e.listener.refreshAnnouncements&&this.props.loadAnnouncements(this.props.courseId,{searchText:this.props.searchInputState.searchText}),this.props.announcements!==e.announcements&&this.shouldStartInfiniteScroll()&&this.loadMore()}componentWillUnmount(){const{root:e,clearAnnouncements:t}=this.props;(e&&e.querySelector(".panel-wrap")||window).removeEventListener("scroll",this.onScroll),(e&&e.querySelector(".panel-wrap")||window).removeEventListener("touchmove",this.onScroll),(0,g.isInMobileApp)()&&(0,g.clearMobileEventHandler)(this.correlationId),t()}render(){const{announcements:e,paging:t,permissions:n,searchInputState:a,courseId:o,courseContext:i,localize:r,announcementsCounts:c,UltraWindowSize:u}=this.props,m=e&&Object.keys(e).length||0,h=(null==u?void 0:u.isMediumBreakpoint())||(null==u?void 0:u.isSmallBreakpoint());return s.createElement("div",{className:"page-announcement course-announcement-layer"},s.createElement("div",{className:"panel-wrap"},s.createElement("header",{className:"panel-header simple-header"},s.createElement("div",{className:"panel-titles-container"},s.createElement("span",{className:"panel-sub-title"},i&&i.displayName||""),s.createElement("div",{className:"editable-title-container black-header-contents"},s.createElement(l.AnalyticsIconButton,{"aria-label":r.translate("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:r.translate("base.menu"),analyticsId:"course.announcements.listPanel.menu.button"},s.createElement(C.MainMenu,null)),s.createElement("h1",{className:"panel-title"},r.translate((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==i?void 0:i.isOrganization))))),s.createElement("div",{className:"header-actions-menu__item active no-select"},s.createElement("div",{className:"active no-select"},s.createElement(l.AnalyticsIconButton,{"aria-label":r.translate("course.announcements.search.placeHolder"),className:"anchor-button",id:"search-button",onClick:this.onToggleSearchInput,title:r.translate("course.announcements.search.placeHolder"),analyticsId:"course.announcements.listPanel.search.button"},h?s.createElement(C.Search,null):s.createElement(f.Search,null))))),s.createElement("div",{className:"guidance-wrapper "+(a.isCollapsed?"":"hide")},c&&(null==t?void 0:t.count)>=0&&s.createElement("span",null,n.viewUnposted?r.translate("course.announcements.guidance.instructor",{postedCount:c.postedCount||0,scheduledCount:c.scheduledCount||0})+r.translate("course.announcements.guidance.draftCount.plural",{draftCount:c.draftCount||0}):r.translate("course.announcements.guidance.student",{totalCount:(null==t?void 0:t.count)||0})),n.create&&s.createElement(l.AnalyticsIconButton,{"aria-label":r.translate("course.announcements.createAnnouncement"),className:"create-announcement",onClick:this.onCreateAnnouncement,title:r.translate("course.announcements.createAnnouncement"),analyticsId:"course.announcements.listPanel.create.button"},h?s.createElement(C.Add,null):s.createElement(f.AddCircle,null))),s.createElement("div",{className:"panel-content"},s.createElement("div",{className:"row collapse "+(a.isCollapsed?"hide":""),id:"announcement-search"},s.createElement(d.default,{courseId:o,debounceTime:1500,isCollapsed:a.isCollapsed,localize:r,minCharToStartSearching:v,notifyStateChange:this.searchInputStateChange,placeHolder:r.translate("course.announcements.search.placeHolder"),searchAnnouncements:this.loadAnnByCurrentSettings,searchText:a.searchText,analyticsId:"course.announcements.listPanel.search.input.text"})),s.createElement("div",{className:"row collapse"},this.renderAnnouncementListView(m),this.props.isLoading?s.createElement("div",{className:"spinner bb-secondary-color-2"}):""))))}}t.AnnouncementListPanel=T,t.default=(0,o.connect)(e=>({announcements:e.announcement.announcements,isLoading:e.announcement.isLoading,isSearchingSuccessful:e.announcement.isSearchingSuccessful,searchInputState:e.announcement.searchInputState,paging:e.announcement.paging,announcementsCounts:e.announcement.announcementsCounts,courseContext:e.announcement.courseContext,sortCriteria:e.announcement.sortCriteria,listener:e.announcement.listener,recentUpdatedAnnouncementIds:e.announcement.recentUpdatedAnnouncementIds}),e=>(0,A.bindActionCreators)({loadAnnouncements:b.actions.announcement.loadAnnouncements,removeAnnouncement:b.actions.announcement.removeAnnouncement,saveAnnouncement:b.actions.announcement.saveAnnouncement,changeSearchInputState:b.actions.announcement.changeSearchInputState,getAnnouncementsCounts:b.actions.announcement.getAnnouncementsCounts,getCourseContext:b.actions.announcement.getCourseContext,switchSortCriteria:b.actions.announcement.switchSortCriteria,clearAnnouncements:b.actions.announcement.clearAnnouncements,removeFromRecentUpdated:b.actions.announcement.removeFromRecentUpdated},e))((0,S.windowResizingResponsiveComponentWrapper)((0,c.localizedComponentWrapper)(T)))},KasK:function(e,t,n){"use strict";n.r(t)},"Kc+f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementSlide=void 0;const a=n("D57K").__importStar(n("ERkP")),s=n("uDfI"),o=n("FS8K"),i=n("np6O"),r=n("WBPx"),l=n("gh1U"),c=n("Pam5"),u=n("IbyE"),d=n("vSnM"),m=n("0x+l"),h=n("50Q+");n("KasK");const p=n("9OUN");class E extends a.Component{constructor(e){super(e),this.onOpenAllAnnouncements=()=>{const{onOpenAllAnnouncements:e}=this.props;e(),this.onDismissAll()},this.openAnnouncementDetail=e=>{const{openAnnouncementDetail:t}=this.props;t(e),this.onDismissAll()},this.onDismissAll=()=>{this.announcementSlides.forEach(e=>this.props.dismissAnnouncementItem(e.sourceEntry)),this.onCloseSlideModal()},this.updateContext=()=>{const{currentViewingIndex:e,currentAnnouncement:t}=this.state,{courseContext:n,getCourseContext:a}=this.props;t&&t.courseId&&e>=0&&(n&&n.courseId===t.courseId||a(t.courseId))},this.onCloseSlideModal=()=>{this.setState({showModal:!1})},this.state={currentAnnouncement:null,currentViewingIndex:-1,showModal:!1}}componentDidMount(){this.props.fetchAnnouncementSlides().then(e=>{e.sort((function(e,t){return e.startDateRestriction&&t.startDateRestriction?e.startDateRestriction.toISOString().localeCompare(t.startDateRestriction.toISOString()):0})),this.announcementSlides=e.slice(),this.announcementSlides.length>0&&this.setState({currentViewingIndex:0,currentAnnouncement:{...this.announcementSlides[0]},showModal:!0},this.updateContext),this.elementCards=this.announcementSlides.map(e=>{var t;return a.createElement("li",{className:"element-card",key:e.id},a.createElement("div",{className:"element-image"},a.createElement(c.Announcement,{color:"primary"})),a.createElement("div",{className:"element-details"},a.createElement("div",{className:"name"},a.createElement("a",{className:"rows-block header-title",onClick:()=>{this.openAnnouncementDetail(e.id)},href:"#"},(0,d.decodeHtmlEntities)(e.title)),a.createElement("span",{className:"rows-block header-sent-date"},(0,d.displayDateTime)(null===(t=e.startDateRestriction)||void 0===t?void 0:t.toISOString(),this.props.localize))),a.createElement("br",null),a.createElement("div",{className:"rows-block body-text message-entries"},a.createElement("p",null,(0,d.decodeHtmlBodyText)(e.body.rawText,this.props.localize)))))})})}render(){const{localize:e,courseContext:t}=this.props;return a.createElement(l.Modal,{isOpen:this.state.showModal,containerClassName:"ms-modalExample-container container-inherit"},a.createElement("div",{className:"notice notification "+this.props.courseColorClass+" reveal-modal course-announcements-slide open in"},a.createElement("div",{className:"title-container"},a.createElement("h1",{className:"title-modal"},e.translate((0,h.resolveCourseOrgToken)("announcements.newCourseAnnouncements",null==t?void 0:t.isOrganization))),a.createElement(i.AnalyticsIconButton,{"aria-label":e.translate("course.announcements.closeModal"),className:"close-modal-button",onClick:this.onDismissAll,analyticsId:"course.announcements.modal.close.button"},a.createElement(m.Close,null))),a.createElement("div",{className:"modal-contents"},a.createElement("ul",{className:"modal-notifications"},this.elementCards)),a.createElement("div",{className:"announcement-modal-footer"},a.createElement(r.AnalyticsPrimaryButton,{onClick:this.onOpenAllAnnouncements,className:"view-all-announcements-button",analyticsId:"course.announcements.slide.view.all.button"},e.translate("course.announcements.button.viewAll")))))}}t.AnnouncementSlide=E,t.default=(0,s.connect)(e=>({courseContext:e.announcement.courseContext}),e=>(0,p.bindActionCreators)({getCourseContext:u.actions.announcement.getCourseContext},e))((0,o.localizedComponentWrapper)(E))},RDpL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementDetailPanel=t.TITLE_CHARACTER_LENGTH=void 0;const a=n("D57K"),s=a.__importStar(n("ERkP")),o=n("uDfI"),i=a.__importDefault(n("wgY5")),r=a.__importDefault(n("7O4Y")),l=n("FS8K"),c=n("MC1S"),u=n("WBPx"),d=n("np6O"),m=n("0x+l"),h=a.__importDefault(n("RK7K")),p=n("vSnM"),E=n("50Q+"),g=n("Y+9S"),S=a.__importDefault(n("Hhhn")),C=n("AuQm"),f=n("Vvvt"),D=n("IbyE"),b=n("vSnM"),A=n("9OUN");n("09zc"),t.TITLE_CHARACTER_LENGTH=256;class y extends s.Component{constructor(e){super(e),this.mappingAnnouncementToState=e=>{const{courseId:t,courseContext:n,getCourseContext:a}=this.props;if(e){const{title:t="",startDateRestriction:n,endDateRestriction:a,isDraft:s,pushNotify:o}=e,r=e.body&&e.body.rawText||"";this.setState({currentBbml:r,currentAnnouncement:e,title:t,isValid:!!t.trim()&&!!r.trim(),isDraft:s,isSendEmailChecked:o}),s||(o?a&&this.setState({isEndChecked:!0,endDate:(0,i.default)(a).toDate(),endTime:(0,i.default)(a).toDate()}):(this.setState({isShowOnChecked:!0,startDate:(0,i.default)(n).toDate(),startTime:(0,i.default)(n).toDate()}),a&&this.setState({isEndChecked:!0,endDate:(0,i.default)(a).toDate(),endTime:(0,i.default)(a).toDate()})))}this.notifyMobileApp(e),n&&n.courseId===t||a(t);const s=this.getMode();this.titleTextField&&this.isEditableMode(s)&&this.titleTextField.focus(),this.updateAnnouncementPanelState(h.default.DUPLICATE.isEqualTo(s),!1)},this.notifyMobileApp=e=>{const t={type:g.MessageType.AnnouncementDetailOpened,status:g.MessageStatus.Success,pageTitle:this.getTitle(e)};(0,g.sendMessageToMobile)(t)},this.getMode=()=>this.props.mode||h.default.VIEW,this.isEditableMode=e=>h.default.EDIT.isEqualTo(e)||h.default.DUPLICATE.isEqualTo(e)||h.default.CREATE.isEqualTo(e),this.onTitleChange=e=>{this.setState(n=>({title:e,isTitleInputPristine:!1,isValid:!!e.trim()&&e.trim().length<=t.TITLE_CHARACTER_LENGTH&&!!n.currentBbml.trim()})),this.updateAnnouncementPanelState(!!e.trim())},this.onMessageChange=e=>{const{currentAnnouncement:n,isMessageEditorPristine:a}=this.state,s=e.toBbML();this.setState(e=>({currentBbml:s,isMessageEditorPristine:!1,isValid:!!s.trim()&&!!e.title.trim()&&e.title.trim().length<=t.TITLE_CHARACTER_LENGTH})),n&&!a?this.updateAnnouncementPanelState(n.body.rawText!==s):n||this.updateAnnouncementPanelState(!!s)},this.onTitleErrorMessage=e=>{const{isTitleInputPristine:n}=this.state;let a="";return n||e.trim().length?!n&&e.trim().length>t.TITLE_CHARACTER_LENGTH&&(a=this.props.localize.translate("course.announcements.errors.messages.titleMaxlength",{maxLength:t.TITLE_CHARACTER_LENGTH})):a=this.props.localize.translate("course.announcements.errors.messages.titleRequired"),a},this.onSave=()=>{if(this.state.isSaving)return;this.setState({isSaving:!0});const e=this.getMode();let{currentAnnouncement:t}=this.state;const{currentBbml:n,title:a,isSendEmailChecked:s,isScheduleChecked:o,isShowOnChecked:i,isEndChecked:r,startDate:l,startTime:c,endDate:u,endTime:d}=this.state,{courseId:m,saveAnnouncement:p,closePanel:E}=this.props;if(l&&c&&l.setHours(c.getHours(),c.getMinutes(),c.getSeconds()),u&&d&&u.setHours(d.getHours(),d.getMinutes(),d.getSeconds()),!t&&h.default.CREATE.isEqualTo(e))(t={}).isDraft=!0,t.title=a,t.body={rawText:n},t.pushNotify=s,o&&(t.isDraft=!1,i&&(t.startDateRestriction=(0,b.buildDateTimeMoment)(l,c).toDate()),t.endDateRestriction=r?(0,b.buildDateTimeMoment)(u,d).toDate():null);else{if(!h.default.DUPLICATE.isEqualTo(e)&&!h.default.EDIT.isEqualTo(e))return console.error("Failed to save announcement!"),void this.setState({isSaving:!1});{const m={...t.body,rawText:n};t={...t,title:a,body:m},h.default.DUPLICATE.isEqualTo(e)&&(t={...t,isDraft:!0,id:null}),t.pushNotify=s,o?(t.isDraft=!1,i&&(t.startDateRestriction=(0,b.buildDateTimeMoment)(l,c).toDate()),t.endDateRestriction=r?(0,b.buildDateTimeMoment)(u,d).toDate():null):(t.isDraft=!0,t.startDateRestriction=null,t.endDateRestriction=null)}}p(m,t).then(()=>{this.updateAnnouncementPanelState(!1,!0),E()})},this.onCancel=()=>{this.props.closePanel()},this.validateInputs=()=>!!this.state.title.trim()&&!!this.state.currentBbml.trim()&&this.state.title.trim().length<=t.TITLE_CHARACTER_LENGTH,this.validateSchedule=()=>{const{isScheduleChecked:e,isShowOnChecked:t,isEndChecked:n,isStartDateValid:a,isStartTimeValid:s,isEndDateValid:o,isEndTimeValid:i}=this.state;if(e){if(t&&(!a||!s))return!1;if(n&&(!o||!i))return!1}return!0},this.onSendEmailChange=()=>{this.updateAnnouncementPanelState(!0),this.setState(e=>({isSendEmailChecked:!e.isSendEmailChecked}))},this.onScheduleChange=()=>{this.updateAnnouncementPanelState(!0),this.setState(e=>({isScheduleChecked:!e.isScheduleChecked,isShowOnChecked:!e.isScheduleChecked&&!e.isSendEmailChecked}))},this.onShowOnChange=()=>{this.setState(e=>({isShowOnChecked:!e.isShowOnChecked})),this.updateAnnouncementPanelState(!0)},this.onHideOnChange=()=>{this.setState(e=>({isEndChecked:!e.isEndChecked})),this.updateAnnouncementPanelState(!0)},this.isEndLaterThanStart=()=>{const{isScheduleChecked:e,isEndChecked:t,isStartDateValid:n,isStartTimeValid:a,isEndDateValid:s,isEndTimeValid:o,startDate:i,startTime:r,endDate:l,endTime:c}=this.state;return!(e&&t&&n&&a&&s&&o&&i&&r&&l&&c)||(0,b.buildDateTimeMoment)(l,c).diff((0,b.buildDateTimeMoment)(i,r))>0},this.state={currentBbml:"",currentAnnouncement:null,title:"",isMessageEditorPristine:!0,isTitleInputPristine:!0,isSaving:!1,isValid:!1,isDraft:!1,isSendEmailChecked:!1,isScheduleChecked:!1,isShowOnChecked:!1,isEndChecked:!1,startDate:null,startTime:null,endDate:null,endTime:null,isStartDateValid:!0,isStartTimeValid:!0,isEndDateValid:!0,isEndTimeValid:!0}}componentDidMount(){const{courseId:e,announcementId:t,announcements:n,announcement:a,getAnnouncement:s,permissions:o}=this.props;h.default.CREATE.isEqualTo(this.getMode())?o.create?this.mappingAnnouncementToState(null):console.error("User is not authorized to create announcement!"):n&&n[t]?this.mappingAnnouncementToState(n[t]):a&&a.id===t?this.mappingAnnouncementToState(a):t?s(e,t).then(()=>{this.mappingAnnouncementToState(this.props.announcement)}):console.error("Unexpected behavior!")}componentDidUpdate(e,t){const{isScheduleChecked:n,isShowOnChecked:a,isSendEmailChecked:s}=this.state;if((t.isScheduleChecked!==n&&n||t.isShowOnChecked!==a&&a)&&!s&&(this.state.startDate&&this.state.startTime||this.setState({startDate:(0,i.default)().toDate(),startTime:(0,i.default)().toDate()})),t.isSendEmailChecked!==s&&s&&(this.state.startDate||this.state.startTime)&&this.setState({startDate:null,startTime:null}),this.state.isEndChecked!==t.isEndChecked&&this.state.isEndChecked&&(!this.state.endDate||!this.state.endTime)){const{startDate:e,startTime:t}=this.state;if(e&&t)this.setState({endDate:(0,i.default)(e).add(1,"days").toDate(),endTime:(0,i.default)(t).add(1,"days").toDate()});else{const e=(0,i.default)().toDate();this.setState({endDate:(0,i.default)(e).add(1,"days").toDate(),endTime:(0,i.default)(e).add(1,"days").toDate()})}}}getTitle(e){const t=this.getMode(),{localize:n}=this.props;let a=e&&(0,p.decodeHtmlEntities)(e.title)||"";return h.default.CREATE.isEqualTo(t)?a=n.translate("course.announcements.newAnnouncement"):h.default.EDIT.isEqualTo(t)?a=n.translate("course.announcements.editAnnouncement",{announcement:a}):h.default.DUPLICATE.isEqualTo(t)&&(a=n.translate("course.announcements.copyAnnouncement",{announcement:a})),a}updateAnnouncementPanelState(e,t=!1){this.props.changeAnnouncementPanelState({isDirty:e,isSaved:t})}get isEditorInputValid(){const{currentBbml:e,isMessageEditorPristine:t}=this.state;return t||e.length>0}renderBbEditorErrorMessage(){return this.isEditorInputValid?null:s.createElement("div",{className:"error-message",role:"alert"},s.createElement(m.Attention,null),s.createElement("span",null,this.props.localize.translate("course.announcements.errors.messages.messageRequired")))}render(){const e=this.getMode(),{permissions:t,courseContext:n,localize:a,pluginConfig:o,fileUploadSettings:i}=this.props,{currentAnnouncement:l,isSaving:g,isValid:D,isSendEmailChecked:b,isScheduleChecked:A,isShowOnChecked:y,isEndChecked:v,startDate:T,startTime:I,endDate:P,endTime:k,isStartDateValid:N,isStartTimeValid:w,isEndDateValid:x,isEndTimeValid:M}=this.state,_=this.getTitle(l),O=(null==l?void 0:l.body.rawText)||"";return(t.viewUnposted||h.default.VIEW.isEqualTo(e))&&s.createElement("div",{className:"announcement-detail-panel"},h.default.VIEW.isEqualTo(e)&&s.createElement("div",{className:"panel-wrap"},s.createElement("header",{className:"panel-header simple-header"},s.createElement("div",{className:"panel-titles-container"},s.createElement("span",{className:"panel-sub-title"},a.translate((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==n?void 0:n.isOrganization))),s.createElement("div",{className:"editable-title-container black-header-contents"},s.createElement(d.AnalyticsIconButton,{className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:a.translate("base.menu"),"aria-label":a.translate("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"},s.createElement(m.MainMenu,null)),s.createElement("h1",{className:"panel-title",title:_},_)))),s.createElement("section",{className:"panel-container panel-content"},s.createElement("div",{className:"body-text"},s.createElement(f.BbEditorWrapper,{editor:{bbml:O,pluginConfig:o,isReadOnly:!0,isToolbarHidden:!0,showWordCount:!1,onChange:this.onMessageChange,placeholder:a.translate("course.announcements.detail.messageDesc")},fileUploadSettings:i})))),this.isEditableMode(e)&&s.createElement("div",{className:"peek-panel-with-footer"},s.createElement("div",{className:"panel-wrap"},s.createElement("header",{className:"panel-header simple-header"},s.createElement("div",{className:"panel-titles-container"},s.createElement("span",{className:"panel-sub-title"},n&&n.displayName||""),s.createElement("div",{className:"editable-title-container black-header-contents"},s.createElement(d.AnalyticsIconButton,{className:"left-off-canvas-toggle menu-toggle standard-button dark-background",title:a.translate("base.menu"),"aria-label":a.translate("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"},s.createElement(m.MainMenu,null)),s.createElement("h1",{className:"panel-title",title:_},_)))),s.createElement("section",{className:"panel-container panel-content -has-footer"},s.createElement(c.TextField,{className:"label-decorator",label:a.translate("course.announcements.detail.title"),value:(0,p.decodeHtmlEntities)(this.state.title),onChanged:this.onTitleChange,placeholder:a.translate("course.announcements.detail.titleDesc"),ref:e=>{this.titleTextField=e},onGetErrorMessage:this.onTitleErrorMessage,required:!0,analyticsId:"course.announcements.detailPanel.title.input.text"}),s.createElement(c.Dropdown,{label:a.translate("course.announcements.detail.recipients"),defaultSelectedKey:"all",required:!0,options:[{key:"all",text:a.translate((0,E.resolveCourseOrgToken)("announcements.detail.allRecipients",null==n?void 0:n.isOrganization),{studentCount:n&&n.membershipCount||0})}],analyticsId:"course.announcements.detailPanel.recipients.dropdown"}),s.createElement("div",{className:"panel-content__field"},s.createElement(c.Label,{className:"panel-content__field__label",id:"announcement-bb-editor-label",required:!0},a.translate("course.announcements.detail.message")),s.createElement("div",{className:(0,r.default)("panel-content__message",{"-invalid":!this.isEditorInputValid})},s.createElement(f.BbEditorWrapper,{editor:{bbml:O,pluginConfig:o,ariaLabelledBy:"announcement-bb-editor-label",ariaRequired:!0,isReadOnly:!1,isToolbarHidden:!1,onChange:this.onMessageChange,placeholder:a.translate("course.announcements.detail.messageDesc"),showWordCount:!0},fileUploadSettings:i})),this.renderBbEditorErrorMessage()),s.createElement("div",null,s.createElement(c.Checkbox,{label:a.translate("course.announcements.button.email"),checked:b,disabled:A,onChange:this.onSendEmailChange,ariaDescribedBy:"email-checkbox-desc",analyticsId:"course.announcements.detailPanel.sendEmail.input.checkbox"}),s.createElement("p",{className:"information-message",id:"email-checkbox-desc"},a.translate("course.announcements.detail.emailDesc")),s.createElement("p",{className:"information-message",id:"email-checkbox-warning"},a.translate("course.announcements.detail.emailRestriction"))),s.createElement("div",null,s.createElement(c.Checkbox,{label:a.translate("course.announcements.button.schedule"),checked:A,onChange:this.onScheduleChange,analyticsId:"course.announcements.detailPanel.scheduleAnnouncement.input.checkbox",disabled:b,ariaDescribedBy:"email-info-checkbox-desc"}),s.createElement("p",{className:"information-message",id:"email-info-checkbox-desc"},a.translate("course.announcements.detail.scheduleEmailInfo")),A&&!b&&s.createElement("div",null,s.createElement("div",null,s.createElement(c.Checkbox,{label:a.translate("course.announcements.dateTimePicker.showOn"),checked:y,disabled:b,onChange:this.onShowOnChange,analyticsId:"course.announcements.detailPanel.showOn.input.checkbox"}),s.createElement("div",{className:"row collapse date-time-inputs"},s.createElement("div",{className:"columns small-6"},s.createElement(S.default,{value:T,disabled:b,onChangeValue:e=>{this.setState({startDate:e})},onValidateCallback:e=>{this.setState({isStartDateValid:e})},isValueValid:N||!y||b,errorFormatMessage:a.translate("components.directives.validation.messages.errors.date"),errorEmptyMessage:a.translate("components.directives.content-visibility.startDateError"),localize:a,analyticsId:"course.announcements.detailPanel.showOn.datePicker"})),s.createElement("div",{className:"columns small-6"},s.createElement(C.TimePicker,{value:I,disabled:b,onChangeValue:e=>{this.setState({startTime:e})},onValidateCallback:e=>{this.setState({isStartTimeValid:e})},isValueValid:w||!y||b,errorFormatMessage:a.translate("components.directives.validation.messages.errors.time"),errorEmptyMessage:a.translate("components.directives.content-visibility.startTimeError"),analyticsId:"course.announcements.detailPanel.showOn.timePicker"})))),s.createElement("div",null,s.createElement(c.Checkbox,{label:a.translate("course.announcements.dateTimePicker.hideOn"),checked:v,onChange:this.onHideOnChange,analyticsId:"course.announcements.detailPanel.hideOn.input.checkbox"}),s.createElement("div",{className:"row collapse date-time-inputs"},s.createElement("div",{className:"columns small-6"},s.createElement(S.default,{value:P,onChangeValue:e=>{this.setState({endDate:e})},onValidateCallback:e=>{this.setState({isEndDateValid:e})},isValueValid:x||!v,disabled:!v,errorFormatMessage:a.translate("components.directives.validation.messages.errors.date"),errorEmptyMessage:a.translate("components.directives.content-visibility.endDateError"),localize:a,analyticsId:"course.announcements.detailPanel.hideOn.datePicker"})),s.createElement("div",{className:"columns small-6"},s.createElement(C.TimePicker,{value:k,onChangeValue:e=>{this.setState({endTime:e})},onValidateCallback:e=>{this.setState({isEndTimeValid:e})},isValueValid:M||!v,disabled:!v,errorFormatMessage:a.translate("components.directives.validation.messages.errors.time"),errorEmptyMessage:a.translate("components.directives.content-visibility.endTimeError"),analyticsId:"course.announcements.detailPanel.hideOn.timePicker"})))),!this.isEndLaterThanStart()&&s.createElement("span",{className:"error-message"},s.createElement(m.Attention,null),a.translate("course.announcements.errors.messages.hideOnShouldLaterThanShowOn")))))),s.createElement("footer",{className:"panel-footer"},s.createElement("span",{className:"place-holder"}),s.createElement(u.AnalyticsDefaultButton,{className:"button-cancel",onClick:this.onCancel,analyticsId:"course.announcements.detailPanel.cancel.button"},a.translate("course.announcements.button.cancel")),s.createElement(u.AnalyticsPrimaryButton,{className:"button-save",disabled:!(D&&this.validateSchedule()&&this.isEndLaterThanStart()),onClick:this.onSave,analyticsId:"course.announcements.detailPanel.save.button"},a.translate("course.announcements.button.save")))),g?s.createElement("div",{className:"spinner bb-secondary-color-2"}):"")}}t.AnnouncementDetailPanel=y,t.default=(0,o.connect)(e=>({announcements:e.announcement.announcements,courseContext:e.announcement.courseContext,announcement:e.announcement.announcement,detailPanelState:e.announcement.detailPanelState,fileUploadSettings:D.select.fileUploadSettings.getFileUploadSettings(e)}),e=>(0,A.bindActionCreators)({saveAnnouncement:D.actions.announcement.saveAnnouncement,getCourseContext:D.actions.announcement.getCourseContext,getAnnouncement:D.actions.announcement.getAnnouncement,changeAnnouncementPanelState:D.actions.announcement.changeAnnouncementPanelState},e))((0,l.localizedComponentWrapper)(y))},RDrG:function(e,t,n){"use strict";n.r(t)},RK7K:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n("D57K").__importDefault(n("nbDY"));class s extends a.default{}t.default=s,s.VIEW=new s("view"),s.CREATE=new s("create"),s.EDIT=new s("edit"),s.DUPLICATE=new s("duplicate"),s.DELETE=new s("delete")},Vvvt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BbEditorWrapper=t.BaseBbEditorWrapper=void 0;const a=n("D57K").__importStar(n("ERkP")),s=n("nsO7"),o=n("ERsv"),i=n("FS8K"),r=n("IbyE");class l extends a.Component{constructor(){super(...arguments),this.getEditorElement=()=>document.querySelector(".bb-editor"),this.prepareEditorPlugins=()=>{const{babelfishFormatInstance:e,babelfishInstance:t,currentLocale:n,editor:a,fileUploadSettings:s}=this.props,i={...a.pluginConfig,babelfishFormatInstance:e,babelfishInstance:t,apiBasePath:r.config.apiBasePath,locale:n,xsrfToken:r.config.xsrf,fileUploadSettings:s},l=[(0,o.link)(),(0,o.image)(),(0,o.video)(),(0,o.insertLocalFile)(i),(0,o.videoEverywhere)(i)];return i.openCloudStorageIntegrationModal&&l.push((0,o.insertCloudStorageIntegrationFile)({openCloudStorageIntegrationModal:i.openCloudStorageIntegrationModal,...i})),i.getEmbedSrc&&l.push((0,o.insertYoutubeVideo)({getEmbedSrc:i.getEmbedSrc,...i})),l},this.focusEditor=()=>{const e=this.getEditorElement();e&&e.focus()}}componentDidMount(){this.props.editor.isReadOnly||this.focusEditor()}shouldComponentUpdate(e){return(0,s.differenceWith)([e.editor],[this.props.editor],s.isEqual).length>0}componentDidUpdate(){this.props.editor.isReadOnly||this.focusEditor()}render(){const{editor:e}=this.props,t=this.prepareEditorPlugins();return a.createElement(o.BbEditor,{...e,plugins:t})}}t.BaseBbEditorWrapper=l,t.BbEditorWrapper=(0,i.localizedComponentWrapper)(l)},cwrT:function(e,t,n){"use strict";n.r(t)},idFC:function(e,t,n){"use strict";n.r(t)},m3mx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PanelModeEnum=t.renderAnnouncementSlide=t.renderAnnouncementDetailPanel=t.renderAnnouncementListPanel=void 0;const a=n("D57K"),s=a.__importStar(n("ERkP")),o=a.__importStar(n("7nmT")),i=a.__importDefault(n("IVgG")),r=a.__importDefault(n("RDpL")),l=a.__importDefault(n("Kc+f")),c=n("uDfI"),u=n("FS8K"),d=a.__importDefault(n("RK7K"));t.PanelModeEnum=d.default;const m=n("tN4z"),h=(e,t,n,a,i,r)=>{let l=n;null==n&&"undefined"!=typeof window&&window.location.search.match("setLang=")&&(l=window.location.search.match(/setLang=([^$&]+)/)[1]),o.render(s.createElement(m.AnalyticsJssThemeProvider,{theme:"light",isRtl:r},s.createElement(u.Locale,{locale:l,babelfishInstance:a,babelfishFormatInstance:i,bundlesToLoad:["announcements/locales/[locale]/announcements.json"],isRtl:r},s.createElement("div",null,e))),t)};t.renderAnnouncementListPanel=(e,t,n,a,o,r,l,u,d)=>{h(s.createElement(c.Provider,{store:t},s.createElement(i.default,{courseId:l,permissions:u,root:e,openAnnouncementDetailPanel:d})),e,n,a,o,r)};t.renderAnnouncementDetailPanel=(e,t,n,a,o,i,l,u,d,m,p,E)=>{h(s.createElement(c.Provider,{store:t},s.createElement(r.default,{courseId:l,announcementId:u,permissions:d,mode:m,closePanel:p,pluginConfig:E})),e,n,a,o,i)};t.renderAnnouncementSlide=(e,t,n,a,o,i,r,u,d,m,p)=>{h(s.createElement(c.Provider,{store:t},s.createElement(l.default,{courseColorClass:r,fetchAnnouncementSlides:u,dismissAnnouncementItem:p,onOpenAllAnnouncements:d,openAnnouncementDetail:m})),e,n,a,o,i)};const p={renderAnnouncementListPanel:t.renderAnnouncementListPanel,destroyAnnouncementListPanel:e=>{o.unmountComponentAtNode(e)},renderAnnouncementDetailPanel:t.renderAnnouncementDetailPanel,destroyAnnouncementDetailPanel:e=>{o.unmountComponentAtNode(e)},renderAnnouncementSlide:t.renderAnnouncementSlide,destroyAnnouncementSlide:e=>{o.unmountComponentAtNode(e)}};t.default=p},vSnM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildDateTimeMoment=t.encodeHtmlEntities=t.decodeOnlyAngleBracketHtmlEntities=t.decodeHtmlBodyText=t.decodeHtmlEntities=t.displayDateTime=void 0;const a=n("D57K"),s=a.__importDefault(n("wgY5")),o=a.__importStar(n("n7/H")),i=n("ERsv"),r=864e5,l="components.directives.duration.agoText";t.displayDateTime=function(e,t){let n="";if(e&&(0,s.default)(e).isValid()){const a=(0,s.default)(e).toDate();if(function(e,t,n){return e>=t&&e<n}((new Date).getTime()-a.getTime(),0,r)){const e=t.formatDuration(a,{},o.ILocaleDateFormat.Short);n=t.translate(l,{durationDate:e.date||"",durationTime:e.time||""})}else n=t.formatDatetime(a,o.ILocaleDatetimeFormat.Short)}return n};const c=document.createElement("textarea");t.decodeHtmlEntities=function(e){return c.innerHTML=e,c.value},t.decodeHtmlBodyText=function(e,t){e=e.replace(/"{"/g,"'{\"").replace(/"}"/g,"\"}'");let n=(new DOMParser).parseFromString(e,"text/html");const a=[{tag:"table",replacementText:`[${t.translate("course.announcements.tableWithContent")}]`}];return n=(0,i.replaceContentInHTML)(n,a),Array.from(n.getElementsByTagName("a")).forEach(e=>{const t=JSON.parse((0,i.fixDoubleQuotesInJSONValues)(e.getAttribute("data-bbfile")));(null==t?void 0:t.alternativeText)?e.textContent=`[${t.alternativeText}]`:(null==t?void 0:t.alt)?e.textContent=`[${t.alt}]`:e.textContent=`[${e.textContent}]`}),n.body.innerHTML=n.body.innerHTML.replace(/</g," <"),(n.body.innerText||n.body.innerHTML).trim()},t.decodeOnlyAngleBracketHtmlEntities=function(e){return null==e?e:e.replace(/&gt;/g,">").replace(/&lt;/g,"<")},t.encodeHtmlEntities=function(e){return null==e?e:e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))},t.buildDateTimeMoment=function(e,t){const n=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());return(0,s.default)(n)}},xG9T:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Ascending="ascending",e.Descending="descending",e.None="none",e.Other="other"}(a||(a={})),t.default=a}}]);