(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"2szi":function(e,t,i){var o=i("ziER"),n=i("5JeM"),s=new o({id:"icon-medium-forward-arrow",use:"icon-medium-forward-arrow-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-forward-arrow"><path d="M13 1l10 11-10 11M23 12H1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});n.add(s);e.exports=s},U2yg:function(e,t){e.exports='<div bb-load-bundle="components/directives/content-navigator" class="content-navigator-container" ng-if="$ctrl.shouldShowNavigator()" >\n  <div class="content-navigator-pre">\n    <a ng-click="$ctrl.navigate(\'previous\')"\n       translate-attrs-values="{contentItem: $ctrl.sibling.previous.title}"\n       bb-translate-attrs="{\'aria-label\': \'components.directives.content-navigator.previous-content-item\'}"\n       ng-if="$ctrl.sibling.previous"\n       href="javascript:void(0);"\n       ng-disabled="!$ctrl.sibling.previous.canEdit() && $ctrl.sibling.previous.isConditionalReleaseLocked()"\n       analytics-id="components.directives.content.content-navigator.previous.link"\n    >\n      <bb-svg-icon icon="back-arrow" size="medium"></bb-svg-icon>\n      <span ng-if="(!$ctrl.content.isTest() && !$ctrl.content.isGradedScorm()) || $ctrl.forceShowTitle === true" class="ellipse" title="{{::$ctrl.sibling.previous.title}}">{{$ctrl.sibling.previous.title}}</span>\n\n      <div ng-if="!$ctrl.sibling.previous.canEdit() && $ctrl.sibling.previous.isConditionalReleaseLocked()"\n           bb-complex-tooltip\n           enhanced-tooltip="true"\n           tooltip-position="bottom"\n           tooltip-open-on-activation="true"\n           tooltip-disable-on-mouse-over="true"\n           tooltip-scope="$ctrl.cr.previous.tooltipScope"\n           tooltip-template="{{::$ctrl.cr.previous.getConditionalReleaseComplexTooltipTemplate()}}"\n           tabindex="0" onclick="return false;">\n        <bb-svg-icon size="small" icon="lock"></bb-svg-icon>\n        <span class="sr-only">{{::$ctrl.cr.previous.tooltips}}</span>\n      </div>\n    </a>\n  </div>\n\n  <div class="content-navigator-next">\n    <a ng-click="$ctrl.navigate(\'next\')"\n       translate-attrs-values="{contentItem: $ctrl.sibling.next.title}"\n       bb-translate-attrs="{\'aria-label\': \'components.directives.content-navigator.next-content-item\'}"\n       ng-if="$ctrl.sibling.next"\n       href="javascript:void(0);"\n       ng-disabled="!$ctrl.sibling.next.canEdit() && $ctrl.sibling.next.isConditionalReleaseLocked()"\n       analytics-id="components.directives.content.content-navigator.previous.link"\n    >\n      <div ng-if="!$ctrl.sibling.next.canEdit() && $ctrl.sibling.next.isConditionalReleaseLocked()"\n           bb-complex-tooltip\n           enhanced-tooltip="true"\n           tooltip-position="bottom"\n           tooltip-open-on-activation="true"\n           tooltip-disable-on-mouse-over="true"\n           tooltip-scope="$ctrl.cr.next.tooltipScope"\n           tooltip-template="{{::$ctrl.cr.next.getConditionalReleaseComplexTooltipTemplate()}}"\n           tabindex="0" onclick="return false;">\n        <bb-svg-icon size="small" icon="lock"></bb-svg-icon>\n        <span class="sr-only">{{::$ctrl.cr.next.tooltips}}</span>\n      </div>\n\n      <span ng-if="(!$ctrl.content.isTest() && !$ctrl.content.isGradedScorm()) || $ctrl.forceShowTitle === true" class="ellipse" title="{{::$ctrl.sibling.next.title}}">{{$ctrl.sibling.next.title}}</span>\n      <bb-svg-icon icon="forward-arrow" size="medium"></bb-svg-icon>\n    </a>\n  </div>\n</div>\n'},aTRN:function(e,t,i){"use strict";var o=i("D57K"),n=i("pjml"),s=i("aHpC"),r=i("4GL6"),a=i("0JpG"),c=i("oi1r"),l=i("TnpK"),p=i("Qbdf"),d=i("X455"),h=i("zGdY"),m=i("IbyE"),u=i("nsO7");const g="performance",v="date";let b=class{constructor(e,t,i,o,n,s,r){this.localizeService=e,this.schemaService=t,this.courseModel=i,this.contextCourse=o,this.contextCourseMembership=n,this.scope=r,this.isPerformanceConditionInvalid=!1,this.role=Object(u.memoize)(()=>this.contextCourseMembership.courseMembership&&this.contextCourseMembership.courseMembership.isStudentMembership()?"student":"instructor"),this.courseId=o.courseId?o.courseId:s.params.courseId}getConditions(e,t,i){var o,n;this.content=e;const s=null===(o=e.adaptiveReleaseRules)||void 0===o?void 0:o.rules;if((null==s?void 0:s.length)||e.isForcedSequenceModule())if((null===(n=null==s?void 0:s[0])||void 0===n?void 0:n.criteria)&&(this.allCriteria=s[0].criteria),this.getACLCriteria()?this.setACLCondition():this.aclToolTips=null,this.getPerformanceCriteria()?this.setPerformanceCondition(t,i):this.performanceToolTips=null,this.getDateCriteria()?this.setDateCondition():this.dateToolTips=null,this.contextCourseMembership.courseMembership.isStudentMembership()&&e.isForcedSequenceItem()){const t=0===e.position?"components.directives.content-item-base.conditionalRelease.student-forced-sequence-first-item-tooltip":"components.directives.content-item-base.conditionalRelease.student-forced-sequence-item-tooltip";this.forcedSequenceTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,noWrap:!0,noEscape:!0}),this.updateTooltipScope()}else this.forcedSequenceTips=null}getConditionDescription(){const e=!!this.getACLCriteria(),t=!!this.getPerformanceCriteria(),i=!!this.getDateCriteria(),o=[[e,this.contextCourse.course.isOrganization?"organization-membership":"course-membership"],[i,v],[t,g]].filter(e=>!!e[0]).map(e=>`components.directives.content-item-base.conditionalRelease.conditionDescriptions.${e[1]}`);if(0===o.length)return;const n=this.localizeService.getLocale(this.scope),s=o.map((e,t)=>this.localizeService.translateSync({locale:n,key:`${e}${0===t?"-capitalized":""}`}));return this.localizeService.formatItemsSync(s,s.length,null,this.scope,!1,{noWrap:!0})}getPerformanceCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.Grade.toString())||this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.GradePercentage.toString())}getDateCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.Date.toString())}getACLCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.ACL.toString())}getCriteriaByType(e){return this.allCriteria&&this.allCriteria.find(t=>t.type===e)}setPerformanceCondition(e,t){this.gradeCriteria=this.getPerformanceCriteria();let i=this.gradeCriteria&&this.gradeCriteria.minScore;const o=this.gradeCriteria&&this.gradeCriteria.maxScore,n=this.gradeCriteria&&this.gradeCriteria.gradeColumnId;let s="",r="";if(!n||t){const e=`components.directives.content-item-base.conditionalRelease.${this.role()}-missing-column-error`;return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope()}this.courseModel.$new(this.courseId||this.content.courseId).gradebook.columns.$find(n).$allow([403]).$then(t=>{if(t.$response&&403===t.$response.status)return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.student-missing-column-error",noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope();let n=`components.directives.content-item-base.conditionalRelease.${this.role()}-lock-tooltip`;n+=void 0===o?"-common":i===o?"-equal":"-custom";const a=e||t&&t.columnName;this.schemaService.loadSchemas(this.courseId).then(e=>{const c=e&&e.find(e=>e.id===t.gradingSchemaId)||{};this.gradeCriteria&&"Grade_Range"===this.gradeCriteria.type&&(void 0===o&&c.scaleType!==h.SchemaScaleType.Score&&c.scaleType!==h.SchemaScaleType.Complete||(s=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:i||0},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}),r=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:o||t.possible},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}))),this.gradeCriteria&&"Grade_Range_Percentage"===this.gradeCriteria.type&&(void 0!==o||c.scaleType===h.SchemaScaleType.Percent?(s=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:i||0},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0}),r=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:o||t.possible},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0})):c.scaleType===h.SchemaScaleType.Tabular&&(c.symbols.sort((e,t)=>e.absoluteTranslation-t.absoluteTranslation),c.symbols.forEach(e=>{e.absoluteTranslation>=i&&(i=e.symbol,s=i)}))),this.getPerformanceToolTips(n,s,r,a)})})}setDateCondition(){if(this.dateCriteria=this.getDateCriteria(),this.dateCriteria){let e=null;this.dateCriteria.start&&this.dateCriteria.end?e="both":this.dateCriteria.start?e="showon":this.dateCriteria.end&&(e="hideafter");const t=`components.directives.content-item-base.conditionalRelease.${this.role()}-${e}-date-tooltip`;this.dateToolTips=e&&this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,params:{showon:new Date(this.dateCriteria.start),hideafter:new Date(this.dateCriteria.end)},noWrap:!0,noEscape:!0}),this.updateTooltipScope()}}setACLCondition(){this.aclCriteria=this.getACLCriteria(),this.aclCriteria&&(this.aclToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.acl-tooltip",noWrap:!0,noEscape:!0}),this.updateTooltipScope())}getPerformanceToolTips(e,t,i,o,n=""){this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,params:{minScore:t,maxScore:i,title:o},noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!1,this.updateTooltipScope()}updateTooltipScope(){angular.isUndefined(this.tooltipScope)&&(this.tooltipScope=this.scope.$new(!0)),this.tooltipScope.items=[],this.aclToolTips&&this.tooltipScope.items.push(this.aclToolTips),this.performanceToolTips&&(this.tooltipScope.items.push(this.performanceToolTips),this.isPerformanceConditionInvalid)?this.tooltips=this.performanceToolTips:(this.dateToolTips&&this.tooltipScope.items.push(this.dateToolTips),this.forcedSequenceTips&&this.tooltipScope.items.push(this.forcedSequenceTips),this.tooltips=this.tooltipScope.items.join(" "))}getConditionalReleaseComplexTooltipTemplate(){return r.a("conditional-release-tooltip")}};b=Object(o.__decorate)([Object(o.__param)(0,Object(s.b)(a.serviceName)),Object(o.__param)(1,Object(s.b)(c.b)),Object(o.__param)(2,Object(s.b)(n.m.serviceName)),Object(o.__param)(3,Object(s.b)(p.e)),Object(o.__param)(4,Object(s.b)(d.d)),Object(o.__param)(5,Object(s.b)(l.d)),Object(o.__param)(6,Object(s.b)("scope"))],b),t.a=b},ftvW:function(e,t,i){"use strict";var o=i("D57K"),n=(i("r+pC"),i("2szi"),i("lwNT"),i("yC9S")),s=i("nYZ0"),r=i("Qbdf"),a=i("X455"),c=i("TnpK"),l=i("aTRN"),p=i("Is+C"),d=i("pjml"),h=i("Q/M7"),m=i("U2yg"),u=i("zGdY"),g=i("nmzr"),v=i("Htol");i.d(t,"a",(function(){return b}));const b="ultra.components.directives.content.contentNavigator";let C=class{constructor(e,t,i,o,n,s,r,a){this.scope=e,this.$state=t,this.timeout=i,this.contentService=o,this.contextCourse=n,this.contextCourseMembership=s,this.$injector=r,this.scormService=a,this.sibling={next:null,previous:null},this.cr={next:null,previous:null}}$onChanges(){this.init()}isStudent(){return this.contextCourseMembership.isStudentMembership()}init(){this.content&&this.isStudent()&&1!==this.content.depth&&this.$state.includes("**.outline.**")&&(this.scope.content=this.content,this.getLearningModuleContent().then(e=>{e.isLearningModule()&&(this.learningModuleContent=e,this.scope.$on(v.b,(e,t,i)=>{i===u.ContentReviewState.Completed&&this.getSibling("next")}),this.getSibling("next"),this.getSibling("previous"))}))}getSibling(e){this.content.getSibling(e,this.learningModuleContent.id).then(t=>{t&&(this.sibling[e]=t,this.cr[e]=this.$injector.instantiate(l.a,{scope:this.scope}),this.cr[e].getConditions(t))})}getLearningModuleContent(){const e=this.contextCourse.course,t=this.contentService.findRootNode(e,d.p.ContentRootNode.ROOT),i=o=>this.contentService.getParentFolder(o.parentId,e.id,t).$asPromise().then(e=>e.isRoot()?o:i(e));return i(this.content)}shouldShowNavigator(){return this.isStudent()&&(!!this.sibling.next||!!this.sibling.previous)}navigate(e){if(!this.sibling[e].canEdit()&&this.sibling[e].isConditionalReleaseLocked())return;const t=this.$state.current.name.split("."),i=t.length-t.lastIndexOf("peek")-1,o=this.sibling[e],n=`content-navigator-transition-${o.isTest()?"peek":"full"}`;this.$state.go("^.".repeat(i)+n).then(this.timeout).then(()=>{if(o.isDiscussionInOutline()){const e=o.contentDetail[d.p.ContentHandler.CourseLink.toString()].linkSourceId;this.$state.go("^.discussion.view.with-grading",{contentId:e})}else if(o.isTest())this.$state.go("^.assessment.overview",{contentId:o.id});else if(o.isDocument())this.$state.go(`^.${g.ContentRoutes.DOCUMENT}`,{id:o.id});else if(o.isJournal())this.$state.go(`^.${g.Routes.Journal.JOURNAL_VIEW_WITH_PARTICIPATION}`,{contentId:o.id});else if(o.isFile())this.$state.go(`^.${g.Routes.File.PREVIEW_FILE}`,{id:o.id});else if(o.isPlaceHolderContent())this.$state.go("^.content-navigator-placeholder",{contentId:o.id});else if(o.isScorm())if(o.getAssociatedGradingColumn())this.$state.go("^.scorm-overview.student",{contentId:o.id});else{let e=h.c(this.scormService.getLaunchLinkFromContent(o));e=h.a(e,"from_ultra","true"),this.$state.go("^.scorm-launch-frame",{toolHref:e,contentId:o.id})}})}};C.$inject=["$scope",c.d,"$timeout",s.f,r.e,a.d,"$injector",p.c],C=Object(o.__decorate)([Object(n.a)({moduleName:b,componentName:"bbContentNavigator",template:m,bindings:{content:"<",forceShowTitle:"<"},requireModules:[s.d,r.b,a.a,c.b,p.b]})],C)},lwNT:function(e,t,i){var o=i("ziER"),n=i("5JeM"),s=new o({id:"icon-small-lock",use:"icon-small-lock-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-lock"><path d="M3 8h10v7H3V8zM5 8V4c0-1.5 1-3 3-3m0 0c.5 0-.5 0 0 0zm0 0c2 0 3 1.5 3 3v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});n.add(s);e.exports=s},"r+pC":function(e,t,i){var o=i("ziER"),n=i("5JeM"),s=new o({id:"icon-medium-back-arrow",use:"icon-medium-back-arrow-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-back-arrow"><path d="M11 23L1 12 11 1M1 12h22" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});n.add(s);e.exports=s}}]);